var M=Object.defineProperty,V=Object.defineProperties;var N=Object.getOwnPropertyDescriptors;var A=Object.getOwnPropertySymbols;var B=Object.prototype.hasOwnProperty,L=Object.prototype.propertyIsEnumerable;var b=(n,e,o)=>e in n?M(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,k=(n,e)=>{for(var o in e||(e={}))B.call(e,o)&&b(n,o,e[o]);if(A)for(var o of A(e))L.call(e,o)&&b(n,o,e[o]);return n},_=(n,e)=>V(n,N(e));import{_ as C,d as $,r as m,o as i,g as a,a as t,e as j,i as l,b as r,l as y,m as g,t as c,w as p,n as P,F as w,f as u,c as F}from"./main.592b4848.js";const x={class:"p-6 bg-white shadow mt-4 prose max-w-none"},D=t("h3",null,"Create API Token",-1),S=t("p",null,"API tokens allow third-party services to authenticate with our application on your behalf.",-1),U={class:"col-span-6 sm:col-span-4"},q={key:0,class:"col-span-6"},z={class:"mt-2 grid grid-cols-1 md:grid-cols-2 gap-4"},E={class:"flex items-center"},Y={class:"ml-2 text-sm text-gray-600"},G=t("span",{class:"material-icons-outlined"}," save_as ",-1),H={key:0,class:"p-6 bg-white shadow mt-4 prose max-w-none"},J={class:"mt-10 sm:mt-0"},K=t("h3",null,"Manage API Tokens",-1),O=t("p",null,"You may delete any of your existing tokens if they are no longer needed.",-1),Q={class:"space-y-6"},R={class:"flex items-center"},W={key:0,class:"text-sm text-gray-400"},X=["onClick"],Z=["onClick"],ee=u(" API Token "),oe=t("div",null," Please copy your new API token. For your security, it won't be shown again. ",-1),se={key:0,class:"mt-4 bg-gray-100 px-4 py-2 rounded font-mono text-sm text-gray-500"},te=u(" Close "),ne=u(" API Token Permissions "),ie={class:"grid grid-cols-1 md:grid-cols-2 gap-4"},ae={class:"flex items-center"},re={class:"ml-2 text-sm text-gray-600"},le=u(" Cancel "),pe=u(" Save "),me={data(){return{createApiTokenForm:{name:"",permissions:this.store.props.defaultPermissions},updateApiTokenForm:{permissions:[]},displayingToken:!1,managingPermissionsFor:null,photoPreview:null}},methods:{async createApiToken(){try{await this.store.axios.post("http://phmoney_app.kainotomo.localhost/phmoney/user/api-tokens",this.createApiTokenForm)}catch{}await this.store.get("http://phmoney_app.kainotomo.localhost/phmoney/user/api-tokens"),this.displayingToken=!0,this.createApiTokenForm={name:"",permissions:this.store.props.defaultPermissions}},manageApiTokenPermissions(n){this.updateApiTokenForm.permissions=n.abilities,this.managingPermissionsFor=n},async updateApiToken(){try{await this.store.axios.put(`http://phmoney_app.kainotomo.localhost/phmoney/user/api-tokens/${this.managingPermissionsFor.id}`,this.updateApiTokenForm)}catch{}await this.store.get("http://phmoney_app.kainotomo.localhost/phmoney/user/api-tokens"),this.managingPermissionsFor=null},async deleteApiToken(n){if(confirm("Are you sure you want to delete this item?")){try{await this.store.axios.delete(`http://phmoney_app.kainotomo.localhost/phmoney/user/api-tokens/${n}`,{})}catch{}await this.store.get("http://phmoney_app.kainotomo.localhost/phmoney/user/api-tokens")}}}},de=$(_(k({},me),{name:"ApiTokenManager",setup(n){return(e,o)=>{const h=m("form-label"),I=m("form-input"),f=m("form-checkbox"),v=m("form-button"),T=m("form-secondary-button");return i(),a("div",null,[t("div",x,[D,S,t("form",{onSubmit:o[2]||(o[2]=j((...s)=>e.createApiToken&&e.createApiToken(...s),["prevent"]))},[l(" Token Name "),t("div",U,[r(h,{for:"name",value:"Name"}),r(I,{id:"name",type:"text",class:"mt-1 block w-full",modelValue:e.createApiTokenForm.name,"onUpdate:modelValue":o[0]||(o[0]=s=>e.createApiTokenForm.name=s),required:"",autofocus:""},null,8,["modelValue"])]),l(" Token Permissions "),e.store.props.availablePermissions&&e.store.props.availablePermissions.length>0?(i(),a("div",q,[r(h,{for:"permissions",value:"Permissions"}),t("div",z,[(i(!0),a(y,null,g(e.store.props.availablePermissions,s=>(i(),a("div",{key:s},[t("label",E,[r(f,{value:s,checked:e.createApiTokenForm.permissions,"onUpdate:checked":o[1]||(o[1]=d=>e.createApiTokenForm.permissions=d)},null,8,["value","checked"]),t("span",Y,c(s),1)])]))),128))])])):l("v-if",!0),r(v,{class:P(["mt-4",{"opacity-25":e.store.processing}]),disabled:e.store.processing,title:"Create"},{default:p(()=>[G]),_:1},8,["class","disabled"])],32)]),e.store.props.tokens&&e.store.props.tokens.length>0?(i(),a("div",H,[l(" Manage API Tokens "),t("div",J,[K,O,t("div",Q,[(i(!0),a(y,null,g(e.store.props.tokens,s=>(i(),a("div",{class:"flex items-center justify-between border-b",key:s.id},[t("div",null,c(s.name),1),t("div",R,[s.last_used_ago?(i(),a("div",W," Last used "+c(s.last_used_ago),1)):l("v-if",!0),e.store.props.availablePermissions.length>0?(i(),a("button",{key:1,class:"cursor-pointer ml-6 text-sm text-gray-400 underline",onClick:d=>e.manageApiTokenPermissions(s)}," Permissions ",8,X)):l("v-if",!0),t("button",{class:"cursor-pointer ml-6 text-sm text-red-500",onClick:d=>e.deleteApiToken(s.id)}," Delete ",8,Z)])]))),128))])])])):l("v-if",!0),l(" Token Value Modal "),r(w,{show:e.displayingToken,onClose:o[4]||(o[4]=s=>e.displayingToken=!1)},{title:p(()=>[ee]),content:p(()=>[oe,e.store.props.jetstream.flash.token?(i(),a("div",se,c(e.store.props.jetstream.flash.token),1)):l("v-if",!0)]),footer:p(()=>[r(T,{onClick:o[3]||(o[3]=s=>e.displayingToken=!1)},{default:p(()=>[te]),_:1})]),_:1},8,["show"]),l(" API Token Permissions Modal "),r(w,{show:e.managingPermissionsFor,onClose:o[7]||(o[7]=s=>e.managingPermissionsFor=null)},{title:p(()=>[ne]),content:p(()=>[t("div",ie,[(i(!0),a(y,null,g(e.store.props.availablePermissions,s=>(i(),a("div",{key:s},[t("label",ae,[r(f,{value:s,checked:e.updateApiTokenForm.permissions,"onUpdate:checked":o[5]||(o[5]=d=>e.updateApiTokenForm.permissions=d)},null,8,["value","checked"]),t("span",re,c(s),1)])]))),128))])]),footer:p(()=>[r(T,{onClick:o[6]||(o[6]=s=>e.managingPermissionsFor=null)},{default:p(()=>[le]),_:1}),r(v,{class:P(["ml-2",{"opacity-25":e.store.processing}]),onClick:e.updateApiToken,disabled:e.store.processing},{default:p(()=>[pe]),_:1},8,["onClick","class","disabled"])]),_:1},8,["show"])])}}}));var ce=C(de,[["__file","/home/phalo/kainotomo/phmoney/phmoney_assets/src/components/api/ApiTokenManager.vue"]]);const ue={async created(){await this.store.get("http://phmoney_app.kainotomo.localhost/phmoney/user/api-tokens")}},he=$(_(k({},ue),{name:"ApiIndex",setup(n){return(e,o)=>{const h=m("FormLayout");return i(),F(h,{title:"API Tokens"},{default:p(()=>[e.store.processing?l("v-if",!0):(i(),F(ce,{key:0}))]),_:1})}}}));var ye=C(he,[["__file","/home/phalo/kainotomo/phmoney/phmoney_assets/src/views/api/ApiIndex.vue"]]);export{ye as default};
