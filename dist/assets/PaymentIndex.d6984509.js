import{_ as F,r as a,o as s,g as r,a as o,k as f,p as y,b as i,w as g,F as h,m as v,t as u,i as V,c as p,n as D,f as P,d as U}from"./main.49a2f634.js";const N={async created(){await this.load(1),this.transfer_account=this.store.props.transfer_accounts[0],this.invoice_account=this.store.props.i_accounts[0],this.bill_account=this.store.props.b_accounts[0]},data(){return{form:{item_guid:null,post_account_guid:null,transfer_account_guid:null,post_date:this.moment().format("YYYY-MM-DD"),credit:0,debit:0,num:null,memo:null},filter:{page:1,search:null,invoice_type:null},transfer_account:null,invoice_account:null,bill_account:null,selected:null}},methods:{async load(t){this.filter.page=t,await this.store.get("/phmoney/business/payment",this.filter)},clear(){this.filter={page:1,search:null,invoice_type:null},this.load(1)},async submit(){this.form.item_guid=this.selected.guid,this.form.post_account_guid=this.store.getInvoiceType(this.selected)==="Invoice"?this.invoice_account.guid:this.bill_account.guid,this.form.transfer_account_guid=this.transfer_account.guid,await this.store.post("/phmoney/business/payment",this.form),this.load(1)},select_item(t){this.selected=t,parseFloat(t.amount)>0?(this.form.credit=t.amount,this.form.debit=0):(this.form.credit=0,this.form.debit=-t.amount)},owner(t){if(t.customer)return t.customer.name;if(t.vendor)return t.vendor.name;if(t.employee)return t.employee.username;if(t.job){if(t.job.customer)return t.job.customer.name;if(t.job.vendor)return t.job.vendor.name}}}},S={class:"p-6 overflow-x-auto"},T={class:"flex flex-wrap gap-2"},j=P(' @change="load(1)"> '),B=o("option",{disabled:"",value:null},"Filter by type",-1),A=o("option",null,"Invoice",-1),q=o("option",null,"Bill",-1),M=o("option",null,"Voucher",-1),Y=[j,B,A,q,M],x=o("span",{class:"material-icons-outlined"}," search ",-1),L=o("span",{class:"material-icons-outlined"}," search_off ",-1),O={key:0},z=o("option",{disabled:"",value:null},"Select post account",-1),E=["value"],R=o("option",{disabled:"",value:null},"Select post account",-1),G=["value"],H=o("thead",null,[o("tr",null,[o("th",null,"Num"),o("th",null,"Opened"),o("th",null,"Due"),o("th",null,"Company"),o("th",null,"Posted"),o("th",null,"Type"),o("th",null,"Debit"),o("th",null,"Credit"),o("th")])],-1),J={key:0},K={key:1},Q={key:2},W={key:1},X={key:3},Z={key:1},$={key:4},ee={key:1},oe={key:5},te={key:1},ne={class:"flex"},se={key:0,class:"text-red-gray hover:text-gray-300"},le=o("span",{class:"material-icons-outlined"},"radio_button_checked",-1),re=[le],ie=["onClick"],ue=o("span",{class:"material-icons-outlined"},"radio_button_unchecked",-1),ae=[ue],de={class:"flex flex-wrap gap-2"},ce=o("option",{disabled:"",value:null},"Select post account",-1),me=["value"],pe={class:"flex gap-2 items-center justify-end mt-4"},_e=o("span",{class:"material-icons-outlined"}," save ",-1);function fe(t,l,C,b,n,d){const c=a("form-input"),k=a("form-button"),w=a("form-secondary-button"),_=a("AmountFinancial"),I=a("Pagination"),m=a("form-label");return s(),r("div",S,[o("div",T,[f(o("select",{"onUpdate:modelValue":l[0]||(l[0]=e=>n.filter.invoice_type=e),name:"invoice_type",id:"invoice_type",class:"border-gray-300 focus:border-sky-300 focus:ring focus:ring-sky-200 focus:ring-opacity-50 rounded-md shadow-sm"},Y,512),[[y,n.filter.invoice_type]]),i(c,{id:"search",name:"search",type:"text",modelValue:n.filter.search,"onUpdate:modelValue":l[1]||(l[1]=e=>n.filter.search=e),placeholder:"Search..."},null,8,["modelValue"]),i(k,{title:"Search by Invoice ID, or Company Name, or Due Date, or Date Opened, or Billing ID, or Invoice Notes, or Invoice Owner",onClick:l[2]||(l[2]=e=>d.load(1))},{default:g(()=>[x]),_:1}),i(w,{title:"Clear",onClick:d.clear},{default:g(()=>[L]),_:1},8,["onClick"]),this.selected?(s(),r("div",O,[t.store.getInvoiceType(this.selected)==="Invoice"?f((s(),r("select",{key:0,id:"invoice_account","onUpdate:modelValue":l[3]||(l[3]=e=>n.invoice_account=e),onChange:l[4]||(l[4]=e=>t.calculate(t.split)),class:"border-gray-300 focus:border-sky-300 focus:ring focus:ring-sky-200 focus:ring-opacity-50 rounded-md shadow-sm"},[z,(s(!0),r(h,null,v(t.store.props.i_accounts,e=>(s(),r("option",{key:e.guid,value:e},u(e.name),9,E))),128))],544)),[[y,n.invoice_account]]):f((s(),r("select",{key:1,id:"bill_account","onUpdate:modelValue":l[5]||(l[5]=e=>n.bill_account=e),onChange:l[6]||(l[6]=e=>t.calculate(t.split)),class:"border-gray-300 focus:border-sky-300 focus:ring focus:ring-sky-200 focus:ring-opacity-50 rounded-md shadow-sm"},[R,(s(!0),r(h,null,v(t.store.props.b_accounts,e=>(s(),r("option",{key:e.guid,value:e},u(e.name),9,G))),128))],544)),[[y,n.bill_account]])])):V("",!0)]),o("table",null,[H,o("tbody",null,[(s(!0),r(h,null,v(t.store.props.items.data,e=>(s(),r("tr",{key:e.guid},[o("td",null,u(e.id),1),o("td",null,u(e.date_opened),1),e.due_date!==null?(s(),r("td",J,u(t.store.convert_date(e.due_date.timespec_val)),1)):(s(),r("td",K)),o("td",null,u(d.owner(e)),1),o("td",null,u(e.date_posted),1),o("td",null,u(t.store.getInvoiceType(e)),1),t.store.getInvoiceType(e)==="Invoice"?(s(),r("td",Q,[parseFloat(e.amount)>0?(s(),p(_,{key:0,amount:parseFloat(e.amount),commodity:n.invoice_account.commodity},null,8,["amount","commodity"])):(s(),r("span",W,"-"))])):(s(),r("td",X,[parseFloat(e.amount)>0?(s(),p(_,{key:0,amount:parseFloat(e.amount),commodity:n.bill_account.commodity},null,8,["amount","commodity"])):(s(),r("span",Z,"-"))])),t.store.getInvoiceType(e)==="Invoice"?(s(),r("td",$,[parseFloat(e.amount)<0?(s(),p(_,{key:0,amount:parseFloat(-e.amount),commodity:n.invoice_account.commodity},null,8,["amount","commodity"])):(s(),r("span",ee,"-"))])):(s(),r("td",oe,[parseFloat(e.amount)<0?(s(),p(_,{key:0,amount:parseFloat(-e.amount),commodity:n.bill_account.commodity},null,8,["amount","commodity"])):(s(),r("span",te,"-"))])),o("td",null,[o("div",ne,[n.selected!==null&&n.selected.guid===e.guid?(s(),r("div",se,re)):(s(),r("div",{key:1,class:"text-red-gray hover:text-gray-300 hover:cursor-pointer",onClick:ve=>d.select_item(e)},ae,8,ie))])])]))),128))]),o("tfoot",null,[t.store.props.items.total>t.store.props.items.per_page?(s(),p(I,{key:0,current:t.store.props.items.current_page,total:t.store.props.items.total,"per-page":t.store.props.items.per_page,onPageChanged:d.load},null,8,["current","total","per-page","onPageChanged"])):V("",!0)])]),o("div",de,[o("div",null,[i(m,{for:"post_date",value:"Date"}),i(c,{id:"post_date",type:"date",modelValue:n.form.post_date,"onUpdate:modelValue":l[7]||(l[7]=e=>n.form.post_date=e),required:""},null,8,["modelValue"])]),o("div",null,[i(m,{for:"credit",value:"Payment"}),i(c,{id:"credit",type:"number",modelValue:n.form.credit,"onUpdate:modelValue":l[8]||(l[8]=e=>n.form.credit=e),min:"0",required:""},null,8,["modelValue"])]),o("div",null,[i(m,{for:"debit",value:"Refund"}),i(c,{id:"debit",type:"number",modelValue:n.form.debit,"onUpdate:modelValue":l[9]||(l[9]=e=>n.form.debit=e),min:"0",required:""},null,8,["modelValue"])]),o("div",null,[i(m,{for:"num",value:"Num"}),i(c,{id:"num",type:"text",modelValue:n.form.num,"onUpdate:modelValue":l[10]||(l[10]=e=>n.form.num=e)},null,8,["modelValue"])]),o("div",null,[i(m,{for:"memo",value:"Memo"}),i(c,{id:"memo",type:"text",modelValue:n.form.memo,"onUpdate:modelValue":l[11]||(l[11]=e=>n.form.memo=e)},null,8,["modelValue"])]),o("div",null,[i(m,{for:"transfer_account",value:"Transfer Account"}),f(o("select",{id:"transfer_account",required:"","onUpdate:modelValue":l[12]||(l[12]=e=>n.invoice_account=e),onChange:l[13]||(l[13]=e=>t.calculate(t.split)),class:"border-gray-300 focus:border-sky-300 focus:ring focus:ring-sky-200 focus:ring-opacity-50 rounded-md shadow-sm"},[ce,(s(!0),r(h,null,v(t.store.props.transfer_accounts,e=>(s(),r("option",{key:e.guid,value:e},u(e.name),9,me))),128))],544),[[y,n.invoice_account]])])]),o("div",pe,[i(k,{class:D({"opacity-25":n.form.processing||n.selected===null}),disabled:n.form.processing||n.selected===null,title:"Save",onClick:d.submit},{default:g(()=>[_e]),_:1},8,["class","disabled","onClick"])])])}var ye=F(N,[["render",fe]]);const he={class:"bg-white shadow mt-4 prose max-w-none"},be=U({name:"PaymentIndex",setup(t){return(l,C)=>{const b=a("AppLayout");return s(),p(b,{title:"Process Payment"},{default:g(()=>[o("div",he,[i(ye)])]),_:1})}}});export{be as default};
